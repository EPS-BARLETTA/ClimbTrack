<!doctype html><html lang="fr"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>ClimbTrack â€” QR de sÃ©ance</title><link rel="stylesheet" href="style.css"></head>
<body><div class="main-wrap"><div class="container">
  <div class="headerbar"><div class="logo">ğŸ“¦ <span class="highlight">QR de sÃ©ance</span></div>
    <div class="right"><a class="btn green big" href="menu.html">ğŸ  Menu</a><a class="btn blue big" href="aide.html">â“ Aide</a></div></div>
  <div class="card"><h2>RÃ©capitulatif</h2><p class="lead" id="idline"></p>

    <div class="row row-2">
      <div class="card"><h3>ğŸ§± Bloc</h3><div id="bzone" class="small">â€”</div></div>
      <div class="card"><h3>ğŸ§— DifficultÃ©</h3><div id="dzone" class="small">â€”</div></div>
    </div>
    <div class="row row-2" style="margin-top:12px;">
      <div class="card"><h3>âš¡ Vitesse</h3><div id="vzone" class="small">â€”</div></div>
      <div class="card"><h3>ğŸ“· CrÃ©ateur de voie</h3><div class="small">CrÃ©e ta voie â†’ <a class="btn edit" href="route-editor.html">Ouvrir</a> (non inclus dans le QR)</div></div>
    </div>

    <div class="center" style="margin-top:16px;">
      <button class="btn green big" id="btn_qr">ğŸ“· Un seul QR pour tout</button>
      <p class="note">Fais scanner ce QR par ton/ta prof â†’ tout ton travail de la sÃ©ance.</p>
      <div id="qr-section" style="display:none;margin-top:12px;">
        <div class="qr-wrap"><div class="qr-box" id="qrs"></div></div>
        <pre class="pre" id="jsons"></pre>
      </div>
    </div>
  </div></div>
  <footer><div class="container"><div class="footer-inner"></div></div></footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script type="module">
import {getIdentite, ensureIdentite, renderFooter, makeQR, loadSeance} from './app.js';
renderFooter(); ensureIdentite(); const id=getIdentite(); document.getElementById('idline').innerHTML=`Ã‰lÃ¨ve : <strong>${id.Prenom} ${id.Nom}</strong> â€” <span class='badge'>Classe : ${id.Classe}</span>`;
function render(){ const s=loadSeance();
  const vTxt=(s.vitesse&&s.vitesse.best)?`Best=${s.vitesse.best} â€¢ NbEssais=${s.vitesse.nb}`:'â€”';
  vzone.textContent=vTxt;
  dzone.textContent=(s.difficulte&&s.difficulte.length)?s.difficulte.map((x,i)=>`D${i+1}:${x.cotation}|X${x.relais}|${x.style}|${x.resultat}${x.motif?':'+x.motif:''}`).join('  |  '):'â€”';
  bzone.textContent=(s.bloc&&s.bloc.length)?s.bloc.map((x,i)=>`B${i+1}:${x.c}-${x.n} (${x.lvl})`).join('  |  '):'â€”';
} render();

document.getElementById('btn_qr').onclick=()=>{
  const s=loadSeance();
  const obj={Nom:id.Nom, Prenom:id.Prenom, Classe:id.Classe};
  if(s.vitesse && s.vitesse.best){ obj.Vitesse={best:s.vitesse.best, nb:s.vitesse.nb}; }
  if(s.bloc && s.bloc.length){ obj.Bloc=s.bloc.map(b=>({couleur:b.c, numero:b.n, niveau:b.lvl})); }
  if(s.difficulte && s.difficulte.length){ obj.Difficulte=s.difficulte; }
  const txt=makeQR('qrs', obj); jsons.textContent=txt; document.getElementById('qr-section').style.display='block';
};
</script></body></html>
